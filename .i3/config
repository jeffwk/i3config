# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod1
set $super Mod4
set $C Control
set $S Mod4
set $M Mod1
set $CM Control+Mod1
set $CS Control+Mod4

font pango:Input Mono 11

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# launch programs
bindsym $C+Return            exec urxvtc
bindsym $C+Shift+Return      exec urxvtc -fn "xft:Inconsolata for Powerline:pixelsize=40"
bindsym $CM+e exec           emacs
bindsym $CM+p exec           (killall pavucontrol || true) && pavucontrol

bindsym $M+Return            exec --no-startup-id kill -s USR1 $(pidof deadd-notification-center)

# kill focused window
bindsym $CM+q                kill

# start rofi run (a program launcher)
bindsym $M+p                 exec rofi -show run
bindsym $M+Shift+p           exec sudo rofi -show run
bindsym $CM+Shift+p          exec rofi-pass

# window focus keys
bindsym $M+Left              focus left
bindsym $M+Down              focus down
bindsym $M+Up                focus up
bindsym $M+Right             focus right

# move window keys
bindsym $M+Shift+Left        move left
bindsym $M+Shift+Down        move down
bindsym $M+Shift+Up          move up
bindsym $M+Shift+Right       move right

# split horizontal/vertical
bindsym $M+h                 split h
bindsym $M+v                 split v
# enter fullscreen mode for the focused container
bindsym $M+f                 fullscreen toggle
# change container layout (stacked, tabbed, toggle split)
bindsym $M+Shift+s           layout stacking
bindsym $M+Shift+w           layout tabbed
bindsym $M+Shift+e           layout toggle split
# toggle tiling / floating
bindsym $M+Shift+space       floating toggle
# change focus between tiling / floating windows
bindsym $M+space             focus mode_toggle
# focus the parent container
bindsym $M+a                 focus parent
# focus the child container
bindsym $M+d                 focus child

set $i3p        python3 ~/bin/i3proj.py
set $project    python3 ~/bin/i3proj.py active-project
set $move_ws    i3-msg move container to workspace
set $go_ws      i3-msg workspace

# switch to workspace
bindsym $M+1                  exec $go_ws $($project)_1
bindsym $M+2                  exec $go_ws $($project)_2
bindsym $M+3                  exec $go_ws $($project)_3
bindsym $M+4                  exec $go_ws $($project)_4
bindsym $M+5                  exec $go_ws $($project)_5
bindsym $M+6                  exec $go_ws $($project)_6
bindsym $M+7                  exec $go_ws $($project)_7
bindsym $M+8                  exec $go_ws $($project)_8
bindsym $M+9                  exec $go_ws $($project)_9
bindsym $M+0                  exec $go_ws $($project)_10

# move focused container to workspace
bindsym $M+Shift+1            exec $move_ws $($project)_1
bindsym $M+Shift+2            exec $move_ws $($project)_2
bindsym $M+Shift+3            exec $move_ws $($project)_3
bindsym $M+Shift+4            exec $move_ws $($project)_4
bindsym $M+Shift+5            exec $move_ws $($project)_5
bindsym $M+Shift+6            exec $move_ws $($project)_6
bindsym $M+Shift+7            exec $move_ws $($project)_7
bindsym $M+Shift+8            exec $move_ws $($project)_8
bindsym $M+Shift+9            exec $move_ws $($project)_9
bindsym $M+Shift+0            exec $move_ws $($project)_10

bindsym $S+o                  move workspace to output right, exec --no-startup-id restart-tray.sh

bindsym $S+Return             exec --no-startup-id  $i3p switch-project
bindsym $S+Control+Return     exec --no-startup-id  $i3p switch-project
bindsym $S+space              exec --no-startup-id  $i3p recent-project
bindsym $S+Left               exec --no-startup-id  $i3p prev-project
bindsym $S+Right              exec --no-startup-id  $i3p next-project
bindsym $S+n                  exec --no-startup-id  $i3p create-project
bindsym $S+d                  exec --no-startup-id  $i3p delete-project
bindsym $S+x                  exec --no-startup-id  $i3p transfer-project
bindsym $CS+x                 exec --no-startup-id  $i3p transfer-project
bindsym $S+l                  exec --no-startup-id  $i3p set-ws-label
bindsym $CS+l                 exec --no-startup-id  $i3p set-ws-label

# reload the configuration file
bindsym $M+Shift+c            reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $M+Shift+r            restart
# bindsym $M+Shift+Control+r    exec --no-startup-id  restart-desktop.sh
bindsym $CM+Return            exec --no-startup-id  restart-desktop.sh
bindsym $M+Shift+Control+n    exec --no-startup-id  restart-notify.sh

# exit i3 (logs you out of your X session)
bindsym $CM+Shift+e           exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# resize window (you can also use the mouse for that)
set $resize "resize: +Width[Right] -Width[Left] +Height[Up] -Height[Down]"
mode $resize {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym j resize shrink width 10 px or 5 ppt
        bindsym k resize grow height 10 px or 5 ppt
        bindsym l resize shrink height 10 px or 5 ppt
        bindsym semicolon resize grow width 10 px or 5 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 5 ppt
        bindsym Down resize grow height 10 px or 5 ppt
        bindsym Up resize shrink height 10 px or 5 ppt
        bindsym Right resize grow width 10 px or 5 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bindsym $mod+r mode $resize

set $ddc_bright  10
set $ddc_input   60
set $ddc         sudo ddcutil --nousb --noverify --sleep-multiplier=0.1
# set $dp1         'PA32U'
# set $dp2         'DELL P2715Q'
# set $dp1_set     -l 'PA32U' setvcp
# set $dp2_set     -l 'DELL P2715Q' setvcp
set $dp1         3
set $dp2         5
set $dp1_set     -b 3 setvcp
set $dp2_set     -b 5 setvcp

bindsym $S+equal              exec --no-startup-id   change-brightness $dp1 + 2
bindsym $S+minus              exec --no-startup-id   change-brightness $dp1 - 2
#bindsym $S+backslash          exec --no-startup-id   $ddc $dp1_set $ddc_bright 92
bindsym $S+backslash          exec --no-startup-id   change-brightness $dp1 96
bindsym $S+0                  exec --no-startup-id   change-brightness $dp1 80

bindsym $C+$S+equal           exec --no-startup-id   change-brightness $dp2 + 2
bindsym $C+$S+minus           exec --no-startup-id   change-brightness $dp2 - 2
bindsym $C+$S+backslash       exec --no-startup-id   change-brightness $dp2 96
bindsym $C+$S+0               exec --no-startup-id   change-brightness $dp2 88

#ddcutil -l 'PA32U' setvcp 60 0x14
bindsym $S+1                  exec --no-startup-id   $ddc $dp1_set $ddc_input 0x14
bindsym $S+2                  exec --no-startup-id   $ddc $dp1_set $ddc_input 0x0f
bindsym $S+3                  exec --no-startup-id   $ddc $dp2_set $ddc_input 0x10
bindsym $S+4                  exec --no-startup-id   $ddc $dp2_set $ddc_input 0x11

bindsym $C+$M+Up              exec --no-startup-id   ~/bin/volume-up.sh
bindsym $C+$M+Down            exec --no-startup-id   ~/bin/volume-down.sh
bindsym $C+$M+m               exec --no-startup-id   ~/bin/toggle-mute.sh

bindsym XF86AudioRaiseVolume  exec --no-startup-id   ~/bin/volume-up.sh
bindsym XF86AudioLowerVolume  exec --no-startup-id   ~/bin/volume-down.sh
bindsym XF86AudioMute         exec --no-startup-id   ~/bin/toggle-mute.sh

bindsym XF86AudioPlay         exec --no-startup-id   playerctl play-pause
bindsym XF86AudioPrev         exec --no-startup-id   playerctl previous
bindsym XF86AudioNext         exec --no-startup-id   playerctl next
bindsym XF86AudioStop         exec --no-startup-id   playerctl stop

bindsym $mod+Control+l        exec --no-startup-id   trigger-xautolock

bindsym $mod+Shift+Control+q  exec --no-startup-id   toggle-qemu win10
bindsym $mod+Shift+Control+s  exec --no-startup-id   toggle-user-service synergys

# start external programs
exec --no-startup-id xrandr --output "HDMI-A-0" --primary --auto --output "DisplayPort-1" --auto --right-of "HDMI-A-0" --dpi 162
exec --no-startup-id xmodmap ~/.Xmodmap
exec --no-startup-id cat ~/.Xresources ~/.Xdefaults | xrdb -merge > /dev/null 2>&1
exec --no-startup-id urxvtd -q -f -o
exec --no-startup-id xset dpms 1230 0 0 s 1230
exec --no-startup-id xset r rate 225 33
# exec --no-startup-id hsetroot -solid '#9a9895'
# exec --no-startup-id hsetroot -solid '#cac0a4'
# exec --no-startup-id hsetroot -solid '#ccc5a8'
# exec --no-startup-id hsetroot -solid '#0e0e0e'
exec --no-startup-id hsetroot -solid '#1a1a1a'
exec --no-startup-id picom -b --experimental-backends
exec --no-startup-id start-xautolock
exec --no-startup-id reload-emacs
exec --no-startup-id sudo systemctl restart colord
exec --no-startup-id bash -c 'sleep 2 && xiccd'
exec --no-startup-id SVPManager
exec --no-startup-ip bash -c 'sleep 2 && start-twmnd.sh'
exec --no-startup-id mount /mnt/huge
exec --no-startup-id python3 ~/bin/i3proj.py run > ~/i3proj.out 2> ~/i3proj.err
exec --no-startup-id stalonetray
# exec --no-startup-id systemctl --user restart auto-rotate
# exec --no-startup-id sudo virsh start win10

# border colors
client.focused #c0c0c0 #c0c0c0 #000000 #aaaaaa
client.focused_inactive #909090 #666666 #cccccc #aaaaaa
client.unfocused #909090 #666666 #cccccc #aaaaaa
# border width
## new_window pixel 0
new_window pixel 2
for_window [class="^.*"] border pixel 2
## border_radius 23
## border_radius 0
# window gaps
set $default_gaps_inner 13
set $default_gaps_outer -2
gaps inner $default_gaps_inner
gaps outer $default_gaps_outer

# gaps edit modes
set $mode_gaps gaps (default[d] | zero[0] | inner[i] | outer[o] | quit[esc])
set $mode_gaps_outer gaps outer (default[d] | zero[0] | increase[+] | decrease[-] | quit[esc])
set $mode_gaps_inner gaps inner (default[d] | zero[0] | increase[+] | decrease[-] | quit[esc])
bindsym $mod+Control+g mode "$mode_gaps"
mode "$mode_gaps" {
    bindsym o      mode "$mode_gaps_outer"
    bindsym i      mode "$mode_gaps_inner"

    bindsym 0      mode "default", exec --no-startup-id i3-msg "gaps inner current set 0" && i3-msg "gaps outer current set 0"
    bindsym d      mode "default", exec --no-startup-id i3-msg "gaps inner current set $default_gaps_inner" && i3-msg "gaps outer current set $default_gaps_outer"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
mode "$mode_gaps_inner" {
    bindsym plus  gaps inner current plus 5
    bindsym minus gaps inner current minus 5
    bindsym 0     mode "default", gaps inner current set 0
    bindsym d     mode "default", gaps inner current set $default_gaps_inner

    bindsym Shift+plus  gaps inner all plus 5
    bindsym Shift+minus gaps inner all minus 5
    bindsym Shift+0     mode "default", gaps inner all set 0
    bindsym Shift+d     mode "default", gaps inner all set $default_gaps_inner

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
mode "$mode_gaps_outer" {
    bindsym plus  gaps outer current plus 5
    bindsym minus gaps outer current minus 5
    bindsym 0     mode "default", gaps outer current set 0
    bindsym d     mode "default", gaps outer current set $default_gaps_outer

    bindsym Shift+plus  gaps outer all plus 5
    bindsym Shift+minus gaps outer all minus 5
    bindsym Shift+0     mode "default", gaps outer all set 0
    bindsym Shift+d     mode "default", gaps outer all set $default_gaps_outer

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# focus_on_window_activation none

# window configurations
for_window [class="mpv"] floating enable
for_window [class="Eog"] floating enable
for_window [class="Nvidia-settings"] floating enable
for_window [class="Gnome-control-center"] floating enable
for_window [class="Gnome-tweak-tool"] floating enable
for_window [class="Pavucontrol"] floating enable
#for_window [class="Nautilus"] floating enable
no_focus [class="stalonetray"]
no_focus [class="trayer"]
no_focus [class="Deadd-notification-center"]
assign [class="stalonetray"] output primary
for_window [class="stalonetray"] border pixel 0
# assign [class="Deadd-notification-center"] output primary
# for_window [class="Deadd-notification-center"] output primary
